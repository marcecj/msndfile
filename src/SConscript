# vim:ft=python
import os

Import("env", "do_debug")

if do_debug:
    env = env.Clone()

    if env['PLATFORM'] == "win32" and 'mingw' not in env['TOOLS']:
        env.AppendUnique(CCFLAGS='/Zi', LINKFLAGS='/DEBUG')
    else:
        env.MergeFlags("-g -O0")

pkg_dir = "+msndfile"

utils_obj     = env.SharedObject("utils.c", srcdir=pkg_dir)
msndread      = env.Mex(["read.c", "read_utils.c", utils_obj], srcdir=pkg_dir)
msndblockread = env.Mex(["blockread.c", "audio_files.c", utils_obj],
                        srcdir=pkg_dir)

mfiles = env.Glob(pkg_dir + os.sep + '*.m', source=False)
target = msndread + msndblockread

Return("target", "mfiles")
