The msndfile Mex extension
==========================
Marc Joliet <marcec@gmx.de>

msndfile is a suite of MATLAB Mex wrappers of the
http://www.mega-nerd.com/libsndfile[libsndfile] C library for reading and
writing audio files.

Introduction
------------

The MATLAB built-in functions for reading and writing WAV files (i.e., `wavread`
and `wavwrite`) have their limitations.  They do not support files larger than 4
GB, and do not support certain non-Microsoft WAV formats (e.g., RF64).  This
leads to users editing `wavread` to support whatever formats they need to use.
This project, msndfile, aims to provide `wavread` and `wavwrite` compatible
functions using the http://www.mega-nerd.com/libsndfile[libsndfile] C library.
This also means that msndfile supports http://www.vorbis.com/[OGG Vorbis] and
(in my opinion much more interesting) the Free Lossless Audio Codec
http://flac.sourceforge.net[FLAC].

Currently, the suite consists of two functions: `msndfile.read` and
`msndfile.blockread`.  The latter is intended solely for reading audio files
block-wise, for instance to process large files that don't fit in RAM.  Still
missing are the corresponding functions for writing data: `msndfile.write` and
`msndfile.blockwrite`.  Just as with `msndfile.read`, `msndfile.write` is
supposed to be API-compatible with `wavwrite`.

Features
--------

The msndfile suite currently has the following features:

- Can read any file type supported by libsndfile, such as FLAC and OGG Vorbis,
  but also various WAV formats not supported by the `wavread` function, e.g.
  Riff64 (RF64), and has no (known) file size limit.
- Supports BWF metadata (the `bext` chunk).
- Can read multiple files in a block-wise manner via the function
  `msndfile.blockread`.
- It is in general more efficient (read: faster) than pure-MATLAB code, except
  under special circumstances which favour the JIT compiler footnote:[The one
  example I can think of is a pure-MATLAB function for block-wise reading of WAV
  files that becomes *extremely* fast when reading the same range of samples
  repeatedly.].

Compatibility with `wavread`
----------------------------

Leaving off the file type extension
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

While `msndfile` supports reading files without the file type extension, i.e.

---------------------------
>> msndfile.read('some_file');
---------------------------

works, the following conditions must be met:

- There may be no ambiguity with regards to which file is meant, unless one of
  the files with the same basename is a WAV file.  For example: if you try to
  read `some_file` and there are two files, `some_file.aiff` and `some_file.flac`,
  msndfile will abort with an error.  However, if there is also a file
  `some_file.wav`, msndfile will read that.
- The format must be what the libsndfile documentation refers to as "simple".
  These "simple formats" are: AIF{F,C}, AU, CAF, FLAC, VOX, Ogg and WAV.
  Additionaly, RAW files are supported, even though RAW is not a "simple format".

For other, more "exotic" file types, it is therefor necessary to provide the
file type extension.

Differences when the file is not a WAV file
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Msndfile may differ in behaviour a bit if a file is not a WAV file.  In these
cases, the following differences to `wavread` hold:

- The opts.fmt struct has no "wFormatTag" field if the file type is not a WAV
  file (which is completely logical).
- Broadcast WAV files produce an additional opts.bext field.
- The opts.info struct may contain fields unique to non-WAV formats.

Warnings and errors
~~~~~~~~~~~~~~~~~~~

Msndfile will of course have its own unique warnings and errors, but might also
print different warnings and errors in identical situations.  This might be less
of a problem in situations where the error is a system error, in which case it
seems that `wavread` and msndfile both print the system error (i.e.,
`strerror(errno)`).

More importantly, though, the error and warning IDs will be different, since
msndfile uses its own ID component 'msndfile:', as per Matlab documentation
footnote:[If requested, I could at least make the mnemonics identical to
`wavread`].

Changes in the behaviour of `wavread`
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

It may be that some `wavread()` behaviour may change over time or may have
changed in the (recent) past.  Msndfile will for simplicity only implement one
type of behaviour.  Here is a list of all known examples:

- In older versions of Matlab trying to read zero samples will instead read a
  file in its entirety.  Newer versions instead return an empty matrix, which is
  what msndfile does.  Note that some versions of Matlab (e.g., 2010a) print a
  large warning that the behaviour will change.

Installation
------------

See the file file://INSTALL.html[INSTALL].

Copyrights
----------

For the copyrights to msndfile, see the file file://LICENSE.html[LICENSE].

The test files test.{raw,flac,wav} are an excerpt of "Glass Cafe" by Jon7 and
are licensed under the "Attribution-NonCommercial-ShareAlike 2.5 Generic (CC
BY-NC-SA 2.5)" license (see
http://creativecommons.org/licenses/by-nc-sa/2.5/[]).

libsndfile is maintained by Erik de Castro Lopo <erikd@mega-nerd.com> and is
licensed under the LGPLv2.1 (included in the source directory, see the file
``LGPL-2.1'').
